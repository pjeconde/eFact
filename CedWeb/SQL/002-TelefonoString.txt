/* Para evitar posibles problemas de pérdida de datos, debe revisar esta secuencia de comandos detalladamente antes de ejecutarla fuera del contexto del diseñador de base de datos.*/
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.Vendedor
	DROP CONSTRAINT FK_Vendedor_Cuenta
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.Tmp_Vendedor
	(
	IdCuenta varchar(50) NOT NULL,
	RazonSocial varchar(50) NOT NULL,
	Calle varchar(30) NOT NULL,
	Nro varchar(6) NOT NULL,
	Piso varchar(5) NOT NULL,
	Depto varchar(5) NOT NULL,
	Sector varchar(5) NOT NULL,
	Torre varchar(5) NOT NULL,
	Manzana varchar(5) NOT NULL,
	Localidad varchar(25) NOT NULL,
	IdProvincia varchar(2) NOT NULL,
	DescrProvincia varchar(50) NOT NULL,
	CodPost varchar(8) NOT NULL,
	NombreContacto varchar(25) NOT NULL,
	EmailContacto varchar(60) NOT NULL,
	TelefonoContacto varchar(50) NOT NULL,
	CUIT numeric(11, 0) NOT NULL,
	IdCondIVA numeric(2, 0) NOT NULL,
	DescrCondIVA varchar(50) NOT NULL,
	NroIngBrutos varchar(13) NOT NULL,
	IdCondIngBrutos numeric(2, 0) NOT NULL,
	DescrCondIngBrutos varchar(50) NOT NULL,
	GLN numeric(13, 0) NOT NULL,
	CodigoInterno varchar(20) NOT NULL,
	FechaInicioActividades datetime NOT NULL
	)  ON [PRIMARY]
GO
IF EXISTS(SELECT * FROM dbo.Vendedor)
	 EXEC('INSERT INTO dbo.Tmp_Vendedor (IdCuenta, RazonSocial, Calle, Nro, Piso, Depto, Sector, Torre, Manzana, Localidad, IdProvincia, DescrProvincia, CodPost, NombreContacto, EmailContacto, TelefonoContacto, CUIT, IdCondIVA, DescrCondIVA, NroIngBrutos, IdCondIngBrutos, DescrCondIngBrutos, GLN, CodigoInterno, FechaInicioActividades)
		SELECT IdCuenta, RazonSocial, Calle, Nro, Piso, Depto, Sector, Torre, Manzana, Localidad, IdProvincia, DescrProvincia, CodPost, NombreContacto, EmailContacto, CONVERT(varchar(50), TelefonoContacto), CUIT, IdCondIVA, DescrCondIVA, NroIngBrutos, IdCondIngBrutos, DescrCondIngBrutos, GLN, CodigoInterno, FechaInicioActividades FROM dbo.Vendedor WITH (HOLDLOCK TABLOCKX)')
GO
DROP TABLE dbo.Vendedor
GO
EXECUTE sp_rename N'dbo.Tmp_Vendedor', N'Vendedor', 'OBJECT' 
GO
ALTER TABLE dbo.Vendedor ADD CONSTRAINT
	PK_Table_Vendedor PRIMARY KEY CLUSTERED 
	(
	IdCuenta
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.Vendedor ADD CONSTRAINT
	FK_Vendedor_Cuenta FOREIGN KEY
	(
	IdCuenta
	) REFERENCES dbo.Cuenta
	(
	IdCuenta
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO